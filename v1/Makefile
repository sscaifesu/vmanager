# Makefile for Proxmox VM Manager
# ç”¨æ³•: make æˆ– make install

CC = gcc
CFLAGS = -Wall -Wextra -O2 -std=c11
TARGET = vm_manager
SOURCE = vm_manager.c
INSTALL_DIR = /usr/local/bin

.PHONY: all clean install uninstall help

all: $(TARGET)

$(TARGET): $(SOURCE)
	@echo "ğŸ”¨ ç¼–è¯‘ $(TARGET)..."
	$(CC) $(CFLAGS) -o $(TARGET) $(SOURCE)
	@echo "âœ… ç¼–è¯‘å®Œæˆï¼"
	@echo ""
	@echo "ä½¿ç”¨æ–¹æ³•:"
	@echo "  sudo ./$(TARGET)          - ç›´æ¥è¿è¡Œ"
	@echo "  make install              - å®‰è£…åˆ°ç³»ç»Ÿ"
	@echo "  make clean                - æ¸…ç†ç¼–è¯‘æ–‡ä»¶"

clean:
	@echo "ğŸ§¹ æ¸…ç†ç¼–è¯‘æ–‡ä»¶..."
	rm -f $(TARGET)
	@echo "âœ… æ¸…ç†å®Œæˆï¼"

install: $(TARGET)
	@echo "ğŸ“¦ å®‰è£… $(TARGET) åˆ° $(INSTALL_DIR)..."
	install -m 755 $(TARGET) $(INSTALL_DIR)/$(TARGET)
	@echo "âœ… å®‰è£…å®Œæˆï¼"
	@echo ""
	@echo "ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨: sudo $(TARGET)"

uninstall:
	@echo "ğŸ—‘ï¸  å¸è½½ $(TARGET)..."
	rm -f $(INSTALL_DIR)/$(TARGET)
	@echo "âœ… å¸è½½å®Œæˆï¼"

help:
	@echo "Proxmox VM Manager - Makefile å¸®åŠ©"
	@echo ""
	@echo "å¯ç”¨ç›®æ ‡:"
	@echo "  make          - ç¼–è¯‘ç¨‹åº"
	@echo "  make clean    - æ¸…ç†ç¼–è¯‘æ–‡ä»¶"
	@echo "  make install  - å®‰è£…åˆ°ç³»ç»Ÿ (éœ€è¦ root)"
	@echo "  make uninstall- ä»ç³»ç»Ÿå¸è½½ (éœ€è¦ root)"
	@echo "  make help     - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"
	@echo ""
	@echo "ä½¿ç”¨ç¤ºä¾‹:"
	@echo "  make && sudo ./$(TARGET)"
	@echo "  sudo make install && sudo $(TARGET)"
